<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="renderer" content="webkit">
    <!--[if lt IE 9]>
    <meta http-equiv="refresh" content="0;ie.html" />
    <![endif]-->

    <link rel="shortcut icon" href="/favicon.ico">
    <link href="/assets/css/bootstrap.min.css?v=3.3.6" rel="stylesheet">
    <link href="/assets/css/font-awesome.min.css?v=4.4.0" rel="stylesheet">
    <link href="/assets/css/animate.css" rel="stylesheet">
    <link href="/assets/css/style.css?v=4.1.0" rel="stylesheet">
    <!--<style>-->
        <!--.td-left,td-right{-->
            <!--text-align: right;-->
            <!--width: 15%;-->
        <!--}-->
        <!--.td-right{-->
            <!--width: 10%;-->
        <!--}-->
    <!--</style>-->
</head>
<body class="gray-bg top-navigation">
<div class="wrapper ">
    <div class="row border-bottom white-bg">
        <nav class="navbar navbar-static-top" role="navigation">
            <div class="navbar-header">
                <button aria-controls="navbar" aria-expanded="false" data-target="#navbar" data-toggle="collapse" class="navbar-toggle collapsed" type="button">
                    <i class="fa fa-reorder"></i>
                </button>
                <a href="" class="navbar-brand">服务处理</a>
            </div>
            <div class="navbar-collapse collapse" id="navbar">
                <ul class="nav navbar-top-links navbar-right">
                    <li>
                        <a id="save">
                            <i class="glyphicon glyphicon-floppy-disk"></i> 保存
                        </a>
                    </li>
                </ul>
                <ul class="nav navbar-top-links navbar-right">
                    <li>
                        <a id="back">
                            <i class="fa fa-reply"></i> 返回
                        </a>
                    </li>
                </ul>
                <ul class="nav navbar-top-links navbar-right">
                    <li>
                        <a >
                            <i class="fa fa-question"></i> 帮助
                        </a>
                    </li>
                </ul>
            </div>
        </nav>
    </div>
    <div class="wrapper wrapper-content">
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <div class="ibox float-e-margins">
                    <div class="ibox-content">
                        <table id="processEdit"
                               data-toggle="table"
                               data-query-params="queryParams"
                               data-mobile-responsive="true"
                               data-pagination="true"
                               data-icon-size="outline"
                               data-search="false"
                               data-striped="true"
                               data-page-size="5"
                               data-page-number="1"
                               data-page-list="[1, 5, 10, 15, 20, 25]">
                            <thead>
                            <tr>
                                <th data-field="serId" data-visible="false">编号</th>
                                <th data-field="serCus">客户</th>
                                <th data-field="serResume">概要</th>
                                <th data-field="serverType">服务类型</th>
                                <th data-field="serCreaterName">创建人</th>
                                <th data-field="serCreaterDate" data-formatter="dateformatter">创建日期</th>
                                <th data-field="serAllotName">分配给</th>
                                <th data-field="serAllotDate" data-formatter="dateformatter">分配时间</th>
                            </tr>
                            </thead>
                            <tbody>
                            </tbody>
                        </table>
                        <br>
                        <form class="form-horizontal" id="processeditform">
                            <div class="form-group">
                                <label for="serHandle" class="col-sm-2 control-label">服务处理：</label>
                                <div class="col-sm-9">
                                	<textarea style="resize: none" name="serHandle" value="" class="form-control" rows="3" id="serHandle" placeholder="服务处理"></textarea>
                                </div>
                            </div>
                            <div class="form-group col-sm-6">
                                <label for="serHandleName" class="col-sm-4 control-label">处理人：</label>
                                <div class="col-sm-7">
                                    <input type="text" value="火鸣佐樱" name="serHandleName" class="form-control" id="serHandleName"/>
                                </div>
		                   </div>

                            <div class="form-group col-sm-6">
                                <label for="serHandleDate" class="col-sm-4 control-label">处理时间：</label>
                                <div class="col-sm-7">
                                    <input type="text" value="" name="serHandleDate" class="form-control" id="serHandleDate"/>
                                </div>
                            </div>
                            <input type="hidden" name="id" value=""/>
                            <input type="submit" style="display:none;" id="submit"/>
                            <br><br><br>
                        </form>
                    </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    </div>
</div>
<!-- 全局js -->
<script src="/assets/js/jquery.min.js?v=2.1.4"></script>
<script src="/assets/js/bootstrap.min.js?v=3.3.6"></script>
<script src="/assets/js/myjs.js"></script>
<script src="/assets/js/bootstrap-datetimepicker.min.js"></script>
<script type="text/javascript" src="/assets/js/jquery.serializejson.js"></script>

<!-- Bootstrap table -->
<script src="/assets/js/plugins/bootstrap-table/bootstrap-table.min.js"></script>
<script src="/assets/js/plugins/bootstrap-table/bootstrap-table-mobile.min.js"></script>
<script src="/assets/js/plugins/bootstrap-table/locale/bootstrap-table-zh-CN.min.js"></script>

<script type="text/javascript">
$(document).ready(function () {
    var url=window.location.search;
    var str=url.substr(1);
    var strs=str.split("=");
    //给隐藏的id赋值
    $("#id").val(strs[1]);
    //先销毁表格
    $('#processEdit').bootstrapTable('destroy');
    //初始化表格,动态从服务器加载数据
    $("#processEdit").bootstrapTable({
        method: "post",  //使用get请求到服务器获取数据
        url: 'http://localhost:8080/service/serviceprocesslist.do',
        queryParams:{serId:strs[1]}, //参数
        dataType:'json',
        success:function (data) {
            if(data.status==0){

            }
        },
        error:function (data) {
            console.info("发生了错误",data);
        }
    });
})
//渲染表格时将日期类型转好格式
function dateformatter(value,row,index) {
    var date=TimestampToDate(row.chcCreateDate);
    return date
}
$("#save").click(function () {
    $("#submit").click();
})
$('form').on('submit',function () {
    var param=$("#processeditform").serializeJSON();
    $.ajax({
        type:'post',
        url:'http://localhost:8080/serve/processedit.do',
        data:param,
        dataType:'json',
        success:function (data) {
            if(data.status==0){
                window.history.go(-1);
            }
        },
        error:function (data) {
            console.info("发生了错误",data)
        }
    })
})
</script>
</body>
</html>
